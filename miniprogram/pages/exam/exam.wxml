<!--è€ƒè¯•å®‰æ’é¡µé¢-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">è€ƒè¯•å®‰æ’</text>
    <text class="update-time" wx:if="{{lastUpdateTime}}">{{lastUpdateTime}}</text>
  </view>

  <!-- å­¦æœŸé€‰æ‹©å™¨ -->
  <view class="term-selector">
    <view class="selector-item" bindtap="showYearPicker">
      <text class="selector-label">å­¦å¹´:</text>
      <text class="selector-value">{{currentYear}}</text>
      <text class="selector-arrow">â–¼</text>
    </view>
    <view class="selector-item" bindtap="showTermPicker">
      <text class="selector-label">å­¦æœŸ:</text>
      <text class="selector-value">{{currentTerm === 1 ? 'ç¬¬ä¸€å­¦æœŸ' : 'ç¬¬äºŒå­¦æœŸ'}}</text>
      <text class="selector-arrow">â–¼</text>
    </view>
    <view class="refresh-btn" bindtap="refreshExams">
      <text class="refresh-icon">ğŸ”„</text>
    </view>
  </view>

  <!-- è€ƒè¯•åˆ—è¡¨ -->
  <view class="exam-list" wx:if="{{examList.length > 0}}">
    <view 
      class="exam-item"
      wx:for="{{examList}}" 
      wx:key="index"
      bindtap="showExamDetail"
      data-index="{{index}}"
    >
      <view class="exam-time">
        <text class="exam-date">{{item.examDate}}</text>
        <text class="exam-time-range">{{item.examTime}}</text>
      </view>
      <view class="exam-info">
        <text class="course-name">{{item.courseName}}</text>
        <text class="exam-location">è€ƒè¯•åœ°ç‚¹ï¼š{{item.location || 'å¾…å®š'}}</text>
        <text class="exam-type" wx:if="{{item.examType}}">è€ƒè¯•ç±»å‹ï¼š{{item.examType}}</text>
        <text class="seat-number" wx:if="{{item.seatNumber}}">åº§ä½å·ï¼š{{item.seatNumber}}</text>
      </view>
      <view class="exam-status">
        <text class="status-badge {{getStatusClass(item.status)}}">{{getStatusText(item.status)}}</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{examList.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— è€ƒè¯•å®‰æ’</text>
    <button class="reload-btn" bindtap="loadExams">é‡æ–°åŠ è½½</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- å­¦å¹´é€‰æ‹©å™¨ -->
  <picker 
    wx:if="{{showYearSelector}}"
    mode="selector"
    range="{{yearRange}}"
    value="{{yearIndex}}"
    bindchange="onYearChange"
    bindcancel="hideYearPicker"
  >
    <view></view>
  </picker>

  <!-- å­¦æœŸé€‰æ‹©å™¨ -->
  <picker 
    wx:if="{{showTermSelector}}"
    mode="selector"
    range="{{['ç¬¬ä¸€å­¦æœŸ', 'ç¬¬äºŒå­¦æœŸ']}}"
    value="{{termIndex}}"
    bindchange="onTermChange"
    bindcancel="hideTermPicker"
  >
    <view></view>
  </picker>
</view>
